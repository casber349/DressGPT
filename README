==================================================
DressGPT 第六階段：精準修復與動力學引擎 (Refinement Stage)
==================================================

核心檔案更新：
- labels_potency.json (標籤梯度化數據庫)
- fashion_advisor.py (智慧診斷與離線報告)
- app.py (四段式強度引擎與連續重繪流)

--------------------------------------------------
技術細節與重大更新：

1. 標籤梯度化與語義權重 (.json 導入)
   - 將穿搭標籤從單一維度進化為「梯度化權重系統」。
   - 建立標籤映射表，確保 AI 在重繪時能區分「核心風格」與「點綴細節」。
   - 有效解決標籤堆疊導致的 Prompt 權重衝突 (Weight Saturation) 問題。

2. 使用者視覺特徵精準捕捉
   - 系統現在會預先掃描使用者上傳圖片的 Embedding，並提取其「固有標籤」。
   - 透過比對使用者標籤與數據庫標籤，精確定位圖片中的「優勢區域」與「待修正區域」。

3. 精準三段式 Prompt 處方系統
   - [A: 基礎層 (Infrastructure)]：維持高畫質底層與人體結構穩定性。
   - [B: 條件層 (Constraints)]：嚴格鎖定性別、季節、場合等物理環境參數。
   - [C: 專屬處方 (Rx Prescription)]：
     - 根據「好鄰居」的優秀標籤與「使用者」的帶毒標籤，動態生成的個性化修復代碼。
     - 實現「保留原圖優點，剔除視覺負載」的精準打擊。

4. 遞迴式連續重繪流 (Iterative Refinement)
   - 支援「重繪 -> 二次評分 -> 調整藥方 -> 再重繪」的自動化循環。
   - 每次重繪都會繼承前次的優化結果，使美學分數呈現階梯式收斂上升。

5. 四段式動態強度引擎 (Dynamic Strength Engine)
   - 基於常態分佈 (Sigma=1.5, Mu=5.0) 的 PR 值連動邏輯：
     - [低分段 (<3.5 分)]：強度 1.00 (完全重塑)。AI 獲取 100% 像素主導權。
     - [中分段 (3.5~6.0 分)]：強度 100 - (0.5 * PR)。慢速衰減區，穩定修正缺陷。
     - [高分段 (6.0~7.0 分)]：強度 2.5 * (100 - PR)。快速衰減區，保護高分結構。
     - [逆天段 (>7.0 分)]：強度保底 0.25。極致微調模式，僅進行像素級拋光。
   - 此引擎徹底解決了「高分樣本重繪即崩毀」的業界難題。

6. 智慧型數據診斷報告 (Offline Backup Advice)
   - 當 Gemini API 達到配額上限時，自動切換至「硬核數據模式」。
   - 報告整合：PR 位階診斷、專家操作建議、使用者標籤分析、單一高分榜樣(ID)參考。
   - 文字化輸出格式優化，即便無 LLM 介入，使用者仍能獲得精確的操作指南。

--------------------------------------------------
實驗結果:
原圖: 3.86 (PR 22)
DressGPT優化後 5.13 (PR 53)

原圖: 5.01 (PR 50)
DressGPT優化後 6.48 (PR 83)

inpaint重點:
「分數越高，重繪強度越低，Mask 面積應越小」。
==================================================